<?php
/* 作者QQ：2769544753，未经允许禁止倒卖！ */
 goto lSuctIXKAc; b7LwiEJ7JK: if (file_exists(CONTENT_FILE)) { goto soCDBfJutJ; } $content = ["\x74\151\x74\x6c\x65\x5f\x70\x72\x65\146\x69\x78" => "\xe6\254\242\350\277\x8e\xe6\x9d\245\xe5\x88\260", "\164\151\164\154\145" => "\345\260\217\347\213\x90\xe5\x8a\241\xe5\231\250", "\163\x75\x62\164\151\164\x6c\145\x5f\x70\x72\145\x66\x69\170" => "\x57\x65\x6c\x63\157\155\x65\x20\x65\x76\x65\x72\171\x6f\x6e\145\x20\x74\157\40\x6d\x79\x20\167\x65\142\163\x69\164\x65", "\163\165\x62\164\151\164\x6c\x65\137\156\x61\155\145" => "\x58\x69\141\x6f\150\x75\x20\x53\x65\x72\166\145\x72", "\160\151\x78\145\154\x5f\x74\x65\170\164" => "\346\210\x91\347\x88\xb1\351\233\250\344\xba\x91", "\151\156\x74\x72\x6f" => '', "\x73\x6b\x69\154\154\163" => [], "\160\x72\157\x6a\145\143\164\x73" => [], "\x63\x6f\156\x74\141\x63\x74" => ["\x65\155\141\x69\154" => '', "\x77\145\143\150\x61\x74" => '', "\147\x69\x74\x68\165\x62" => '']]; file_put_contents(CONTENT_FILE, json_encode($content, JSON_UNESCAPED_UNICODE | JSON_PRETTY_PRINT)); soCDBfJutJ: if (file_exists(MESSAGES_FILE)) { goto DplNoqMw2n; } goto rxeHiVWFbK; i2PTaJxIuz: KD6VrHPIMM: if (file_exists(ADMIN_FILE)) { goto mQs4MoqHHZ; } $admin = ["\x75\163\145\162\x6e\x61\x6d\x65" => DEFAULT_ADMIN_USER, "\160\x61\163\x73\167\157\162\x64\137\x68\141\163\x68" => password_hash(DEFAULT_ADMIN_PASS, PASSWORD_DEFAULT), "\163\155\164\160" => ["\x68\157\x73\164" => '', "\x70\157\x72\164" => 587, "\x65\156\143\x72\171\160\164\151\x6f\x6e" => "\x74\154\x73", "\165\x73\145\x72\x6e\141\x6d\145" => '', "\x70\x61\163\163\167\157\x72\144" => '', "\146\x72\157\155\137\156\141\155\x65" => "\345\260\217\347\213\220\345\x8a\241\xe5\x99\xa8", "\146\x72\157\x6d\137\145\155\x61\151\x6c" => '']]; file_put_contents(ADMIN_FILE, json_encode($admin, JSON_UNESCAPED_UNICODE | JSON_PRETTY_PRINT)); mQs4MoqHHZ: goto b7LwiEJ7JK; rxeHiVWFbK: file_put_contents(MESSAGES_FILE, "\133\x5d"); DplNoqMw2n: function read_json($file) { if (file_exists($file)) { goto xFxZ8WzD42; } return null; xFxZ8WzD42: $data = file_get_contents($file); return json_decode($data, true); } function write_json($file, $data) { return file_put_contents($file, json_encode($data, JSON_UNESCAPED_UNICODE | JSON_PRETTY_PRINT | JSON_UNESCAPED_SLASHES), LOCK_EX); } function e($str) { return htmlspecialchars($str, ENT_QUOTES, "\125\x54\x46\55\70"); } goto T84EZq6mvQ; T84EZq6mvQ: function rate_limit($action, $identifier, $maxAttempts, $windowSeconds) { goto ikpRMtK0V1; hGejCh2bpw: unset($data[$key]); CaP6_BFkEz: if (!(isset($data[$key]) && ($data[$key]["\x63\157\165\x6e\164"] ?? 0) >= $maxAttempts)) { goto ssaKr2z8l5; } $remaining = ($data[$key]["\x65\170\x70\x69\x72\x65\x73"] ?? $now) - $now; return ["\141\154\x6c\157\167\145\x64" => false, "\x72\145\164\x72\x79\137\x61\146\164\145\x72" => max(0, $remaining)]; goto XudX_GLHYK; qZcX0zMn6n: $data[$key] = ["\x63\157\x75\x6e\x74" => 1, "\x65\x78\x70\151\x72\145\x73" => $now + $windowSeconds]; ugByPk4nsy: if (!(mt_rand(1, 50) === 1)) { goto CCrbe6nKb_; } foreach ($data as $k => $v) { if (!($now > ($v["\x65\x78\x70\x69\162\x65\163"] ?? 0))) { goto LhwQqzlZ_3; } unset($data[$k]); LhwQqzlZ_3: LJ4UJToIkV: } pfCiIXbCV_: goto zx9mfDN0pS; XudX_GLHYK: ssaKr2z8l5: if (!isset($data[$key])) { goto yQQEJICPTW; } $data[$key]["\143\x6f\165\156\164"]++; goto ugByPk4nsy; yQQEJICPTW: goto qZcX0zMn6n; zx9mfDN0pS: CCrbe6nKb_: file_put_contents($file, json_encode($data), LOCK_EX); return ["\x61\154\x6c\x6f\167\x65\144" => true, "\x72\x65\164\x72\171\137\x61\x66\164\x65\x72" => 0]; goto YpEQIgOdRL; ikpRMtK0V1: $file = RATE_LIMIT_FILE; $data = file_exists($file) ? json_decode(file_get_contents($file), true) ?: [] : []; $key = $action . "\72" . md5($identifier); $now = time(); if (!(isset($data[$key]) && $now > ($data[$key]["\145\x78\160\x69\x72\x65\x73"] ?? 0))) { goto CaP6_BFkEz; } goto hGejCh2bpw; YpEQIgOdRL: } goto MTCziHuqx3; lSuctIXKAc: ini_set("\144\151\x73\x70\154\x61\x79\x5f\x65\162\162\x6f\162\163", "\60"); error_reporting(E_ALL); ini_set("\x6c\157\147\137\145\x72\162\x6f\162\163", "\61"); define("\122\x4f\x4f\x54\x5f\x44\111\122", dirname(__DIR__)); define("\x44\x41\124\101\x5f\104\x49\122", ROOT_DIR . DIRECTORY_SEPARATOR . "\x64\x61\164\x61"); goto ZgJMzCQMNT; ZgJMzCQMNT: define("\x43\x4f\116\124\105\116\124\137\106\x49\x4c\x45", DATA_DIR . DIRECTORY_SEPARATOR . "\x63\x6f\156\x74\145\156\164\x2e\x6a\x73\157\x6e"); define("\x4d\105\123\x53\101\x47\x45\x53\x5f\x46\x49\x4c\105", DATA_DIR . DIRECTORY_SEPARATOR . "\155\x65\163\163\141\147\x65\x73\x2e\x6a\163\x6f\156"); define("\x41\104\x4d\x49\x4e\137\x46\111\114\x45", DATA_DIR . DIRECTORY_SEPARATOR . "\141\144\x6d\151\x6e\x2e\152\163\157\x6e"); define("\x52\x41\124\105\137\114\111\115\111\124\137\106\111\x4c\105", DATA_DIR . DIRECTORY_SEPARATOR . "\x72\x61\x74\x65\x5f\154\151\155\151\x74\163\56\152\x73\x6f\156"); define("\123\105\123\x53\111\x4f\116\137\x4e\101\x4d\x45", "\146\x6f\x78\x5f\141\144\155\x69\x6e"); goto mLmCAX0hi3; mLmCAX0hi3: define("\123\x45\123\123\x49\117\116\137\114\x49\x46\x45\124\111\x4d\x45", 7200); define("\x44\x45\106\x41\125\114\x54\137\x41\x44\115\111\x4e\x5f\x55\x53\105\122", "\141\x64\x6d\151\156"); define("\x44\105\x46\x41\125\114\124\x5f\101\x44\115\x49\116\137\120\101\123\123", "\141\144\155\x69\156\61\62\x33"); if (is_dir(DATA_DIR)) { goto KD6VrHPIMM; } mkdir(DATA_DIR, 0755, true); goto i2PTaJxIuz; MTCziHuqx3: function get_client_ip() { $headers = ["\x48\124\x54\120\x5f\130\x5f\106\x4f\x52\x57\101\122\x44\105\104\x5f\106\x4f\122", "\110\124\124\x50\137\x58\137\x52\105\x41\114\x5f\111\x50", "\x52\x45\115\x4f\x54\x45\x5f\x41\x44\x44\x52"]; foreach ($headers as $header) { if (empty($_SERVER[$header])) { goto vV5p_PisN7; } $ip = trim(explode("\54", $_SERVER[$header])[0]); if (!filter_var($ip, FILTER_VALIDATE_IP)) { goto uqKmttC_3P; } return $ip; uqKmttC_3P: vV5p_PisN7: wZcR0b23mg: } GpJvM7SFwv: return $_SERVER["\122\x45\x4d\117\124\x45\137\101\x44\x44\122"] ?? "\60\x2e\60\x2e\x30\56\x30"; }